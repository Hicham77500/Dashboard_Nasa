<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroid Tracker</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <nav>
        <a href="/">ğŸ  Accueil</a>
        <a href="/admin">ğŸ›°ï¸ Administration</a>
    </nav>

<main>
    {% block content %}{% endblock %}
</main>

<footer>
    <p>ğŸš€<span id="lastUpdateFooter">--</span></p>
    <p>ğŸŒŸ Projet dÃ©veloppÃ© par <strong>Hicham Guendouz</strong>, <strong>Ilyas Maalal</strong> et <strong>Boussad Ait Djoudi Oufella</strong></p>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const lastUpdateElement = document.getElementById("lastUpdate");
        const lastUpdateFooter = document.getElementById("lastUpdateFooter");
        const nextUpdateTimer = document.getElementById("nextUpdateTimer");

        // Charger la date de la derniÃ¨re mise Ã  jour
        let lastUpdateTime = localStorage.getItem("lastUpdate");
        if (lastUpdateTime) {
            lastUpdateFooter.innerHTML = `ğŸ“… ${lastUpdateTime}`;
        } else {
            lastUpdateFooter.innerHTML = "ğŸ“… Aucune mise Ã  jour rÃ©cente.";
        }

        // Calcul de la prochaine mise Ã  jour (toutes les 24h aprÃ¨s la derniÃ¨re)
        function calculateNextUpdate() {
            if (lastUpdateTime) {
                let lastUpdateDate = new Date(lastUpdateTime);
                let nextUpdateDate = new Date(lastUpdateDate);
                nextUpdateDate.setHours(nextUpdateDate.getHours() + 24);

                function updateTimer() {
                    let now = new Date();
                    let timeDiff = nextUpdateDate - now;

                    if (timeDiff <= 0) {
                        nextUpdateTimer.innerHTML = "ğŸ“¡ Mise Ã  jour en cours...";
                    } else {
                        let hours = Math.floor(timeDiff / (1000 * 60 * 60));
                        let minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                        let seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                        nextUpdateTimer.innerHTML = `â³ ${hours}h ${minutes}m ${seconds}s`;
                    }
                }

                updateTimer();
                setInterval(updateTimer, 1000); // Mettre Ã  jour chaque seconde
            } else {
                nextUpdateTimer.innerHTML = "ğŸ“¡ En attente de la premiÃ¨re mise Ã  jour...";
            }
        }

        calculateNextUpdate();
    });
</script>

</body>
</html>